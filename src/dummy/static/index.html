<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

<div id="app">
    <img id="map" src="https://robolab.inf.tu-dresden.de/images/planet.png?classes=fixedWidth50,inline&lightbox=false">
    <img id="robot" src="robot.png"
         :style="{top: top + 'px', left: left + 'px', transform: 'rotate(' + rotation + 'deg)'}">
</div>

<script>
    const {createApp} = Vue

    createApp({
        data() {
            return {
                pos: {
                    x: 317,
                    y: -1,
                    rotation: 0
                }
            }
        },
        computed: {
            top() {
                return this.pos.y * -130 + 360
            },
            left() {
                return (this.pos.x - 310) * 128 + 160
            },
            rotation() {
                return this.pos.orientation
            }
        },
        methods: {
            refreshPosition() {
                fetch('/position')
                    .then(response => response.json())
                    .then(data => {
                        this.pos = data
                    })
            }
        },
        mounted() {
            this.refreshPosition()
            setInterval(this.refreshPosition, 500)
        }
    }).mount('#app')
</script>

<style>
    #app {
        position: relative;
        width: 1200px;
    }

    #app #map {
        position: absolute;
        width: 100%;
    }

    #app #robot {
        position: absolute;
        width: 50px;
        top: 50px;
        left: 50px;
        z-index: 99;
        transition: .25s;
    }
</style>