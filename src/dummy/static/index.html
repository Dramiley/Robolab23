<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

<div id="app">
    <img id="map" src="Fassaden-M1.png">
    <img id="robot" src="robot.png"
         :style="{top: top + 'px', left: left + 'px', transform: 'rotate(' + rotation + 'deg)'}">

    <div id="info">
        Current position: {{ pos.x }}, {{ pos.y }}, {{ pos.orientation }}Â°
    </div>
</div>

<script>
    const {createApp} = Vue

    createApp({
        data() {
            return {
                pos: {
                    x: 5,
                    y: -1,
                    rotation: 0
                }
            }
        },
        computed: {
            top() {
                return (this.pos.y * -132) + 635
            },
            left() {
                return ((this.pos.x - 3) * 135) + 5
            },
            rotation() {
                return this.pos.orientation
            }
        },
        methods: {
            refreshPosition() {
                fetch('/position')
                    .then(response => response.json())
                    .then(data => {
                        this.pos = data
                    })
            }
        },
        mounted() {
            this.refreshPosition()
            setInterval(this.refreshPosition, 200)
        }
    }).mount('#app')
</script>

<style>
    #app {
        position: relative;
        height: 800px;
    }

    #app #map {
        position: absolute;
        height: 100%;
    }

    #app #robot {
        position: absolute;
        width: 50px;
        top: 50px;
        left: 50px;
        z-index: 99;
        transition: .25s;
    }

    #app #info {
        position: absolute;
        bottom: 0;
        left: 0;
        padding: 10px;
        background: rgba(0, 0, 0, 0.5);
        color: white;
    }
</style>